---
import { slugify } from "@lib/string";

const { series, posts, currentPost } = Astro.props;
---

<aside
    class="relative my-12 rounded-xl border border-slate-200 bg-slate-50 overflow-hidden shadow-sm"
>
    <!-- Accent bar -->
    <div
        class="absolute inset-y-0 left-0 w-1 bg-gradient-to-b from-slate-700 to-slate-400 rounded-l-xl"
    >
    </div>

    <div class="pl-6 pr-5 pt-5 pb-6">
        <!-- Header -->
        <div class="flex items-center gap-3 mb-5">
            <div
                class="flex items-center gap-1.5 rounded-full bg-slate-800 px-3 py-1 text-xs font-semibold tracking-widest text-white uppercase shrink-0"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="12"
                    height="12"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2.5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    aria-hidden="true"
                >
                    <path d="M4 6h16M4 10h16M4 14h10M4 18h6"></path>
                </svg>
                Series
            </div>
            <h3
                class="font-semibold text-slate-800 text-lg leading-snug truncate"
                style="font-family: var(--font-heading)"
            >
                {series}
            </h3>
        </div>

        <!-- Post list -->
        <ol class="flex flex-col gap-1.5">
            {
                posts.map((post: any, index: number) => {
                    const isCurrent = currentPost === post.frontmatter.title;
                    return (
                        <li>
                            <a
                                href={`/posts/${slugify(post.frontmatter.title)}`}
                                aria-current={isCurrent ? "page" : undefined}
                                class:list={[
                                    "flex items-start gap-3 rounded-lg px-3 py-2.5 text-sm transition-colors duration-150",
                                    isCurrent
                                        ? "bg-slate-800 text-white shadow-sm pointer-events-none"
                                        : "text-slate-600 hover:bg-slate-200 hover:text-slate-900",
                                ]}
                            >
                                <span
                                    class:list={[
                                        "mt-px flex h-5 w-5 shrink-0 items-center justify-center rounded-full text-xs font-bold tabular-nums",
                                        isCurrent
                                            ? "bg-white/20 text-white"
                                            : "bg-slate-200 text-slate-500",
                                    ]}
                                >
                                    {index + 1}
                                </span>
                                <span
                                    class:list={[
                                        "leading-snug",
                                        isCurrent && "font-semibold",
                                    ]}
                                >
                                    {post.frontmatter.title}
                                    {isCurrent && (
                                        <span class="ml-2 inline-block rounded-full bg-white/20 px-1.5 py-0.5 text-[10px] font-medium tracking-wide uppercase">
                                            You are here
                                        </span>
                                    )}
                                </span>
                            </a>
                        </li>
                    );
                })
            }
        </ol>
    </div>
</aside>
